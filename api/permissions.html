<html>
  <head>
    <title>API - permissions - Kanso Framework</title>
    <link rel="stylesheet" href="http://yandex.st/highlightjs/5.16/styles/github.min.css">
    <link rel="stylesheet" href="../css/kanso.css" />
    <!--[if IE]>
      <link rel="stylesheet" href="../css/kanso_ie.css" />
    <![endif]-->
  </head>
  <body>
    <div id="topbar">
      <a id="logo" href="../index.html">
        <img src="../images/kanso_small.png" />
      </a>
      <a id="site" href="../index.html">Framework</a>
      <div id="rightmenu">
        <ul id="topmenu">
          <li>
            <a href="../index.html">About</a>
          </li>
          <li>
            <a href="../guides/index.html">Guides</a>
          </li>
          <li>
            <a href="../community.html">Community</a>
          </li>
          <li class="active">
            <a href="../api/index.html">API</a>
          </li>
          <li>
            <a href="https://github.com/caolan/kanso">Code</a>
          </li>
          <li>
            <a href="../download.html">Download</a>
          </li>
        </ul>
        <!--
        <ul id="sessionmenu">
          <li><a href="#">Create Account</a></li>
          <li><a href="#">Sign In</a></li>
        </ul>
        -->
      </div>
    </div>

    <div id="content">
      <h1>Kanso API Documentation</h1><p><a href="index.html">Index</a> | <a href="all.html">View on single page</a></p><div class="toc"><h2>Table of Contents</h2><ul><li><a href="#permissions">permissions</a><ul><li><a href="#permissions.matchUsername">matchUsername()</a></li><li><a href="#permissions.hasRole">hasRole(role)</a></li><li><a href="#permissions.fieldUneditable">fieldUneditable()</a></li><li><a href="#permissions.usernameMatchesField">usernameMatchesField(path)</a></li><li><a href="#permissions.loggedIn">loggedIn()</a></li><li><a href="#permissions.all">all(perms)</a></li><li><a href="#permissions.any">any(perms)</a></li><li><a href="#permissions.inherit">inherit(type)</a></li></ul></li></ul></div><h2 id="permissions">permissions</h2><p>Permissions functions are used on both Fields and Types to check a given
user is authorized to make a change to a document.</p><h3 id="permissions.matchUsername">matchUsername()</h3><p>Field's new value should match current user's name</p><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.hasRole">hasRole(role)</h3><p>Checks if the user has a specific role</p><h4>Parameters</h4><table class="params"><tr><td class="name">role</td><td class="type">String</td><td class="description"></td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.fieldUneditable">fieldUneditable()</h3><p>The value of this field should never change after the document has been
created.</p><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.usernameMatchesField">usernameMatchesField(path)</h3><p>User's name should match the <em>old</em> value of the given field. A field can be
specified using a string or an array of strings (like a path).</p>

<pre>
eg: usernameMatchesField('creator')
    usernameMatchesField(['meta','creator'])

    {
        creator: 'name',
        meta: {creator: 'name2'}
    }
</pre><h4>Parameters</h4><table class="params"><tr><td class="name">path</td><td class="type">String | Array</td><td class="description"></td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.loggedIn">loggedIn()</h3><p>Checks that user's context has a username</p><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.all">all(perms)</h3><p>Runs an array of permissions functions and checks that all of them pass,
returning all failures.</p><h4>Parameters</h4><table class="params"><tr><td class="name">perms</td><td class="type">Array</td><td class="description"></td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Function</span></div><h3 id="permissions.any">any(perms)</h3><p>Tests to see if any one permission function passes, returning on the
first success. If all permissions fail, then all errors are returned.</p><h4>Parameters</h4><table class="params"><tr><td class="name">perms</td><td class="type">Array</td><td class="description"></td></tr></table><h3 id="permissions.inherit">inherit(type)</h3><p>Treat new and old values like new documents of a given type, and attempt to
authorize the value against the type's permissions. Useful when handling
permissions for an embedded type.</p>

<p>Can be combined with permissions.any or permissions.all to extend the
permissions for an embedded type field. For example, the following might
allow both the owner of the parent document and the owner of the comment
itself to remove it.</p>

<pre><code class="javascript">
    comment: fields.embed({
        type: types.comment,
        permissions: {
            remove: permissions.any([
                permissions.usernameMatchesField('creator'),
                permissions.inherit(types.comment)
            ])
        }
    });
</code></pre><h4>Parameters</h4><table class="params"><tr><td class="name">type</td><td class="type">Type</td><td class="description"></td></tr></table>
    </div>

    <script src="http://yandex.st/highlightjs/5.16/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-20477836-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
