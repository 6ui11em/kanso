<html>
  <head>
    <title>API - types - Kanso Framework</title>
    <link rel="stylesheet" href="http://yandex.st/highlightjs/5.16/styles/github.min.css">
    <link rel="stylesheet" href="../css/kanso.css" />
    <!--[if IE]>
      <link rel="stylesheet" href="../css/kanso_ie.css" />
    <![endif]-->
  </head>
  <body>
    <div id="topbar">
      <a id="logo" href="../index.html">
        <img src="../images/kanso_small.png" />
      </a>
      <a id="site" href="../index.html">Framework</a>
      <div id="rightmenu">
        <ul id="topmenu">
          <li>
            <a href="../index.html">About</a>
          </li>
          <li>
            <a href="../guides/index.html">Guides</a>
          </li>
          <li>
            <a href="../community.html">Community</a>
          </li>
          <li class="active">
            <a href="../api/index.html">API</a>
          </li>
          <li>
            <a href="https://github.com/caolan/kanso">Code</a>
          </li>
          <li>
            <a href="../download.html">Download</a>
          </li>
        </ul>
        <!--
        <ul id="sessionmenu">
          <li><a href="#">Create Account</a></li>
          <li><a href="#">Sign In</a></li>
        </ul>
        -->
      </div>
    </div>

    <div id="content">
      <h1>Kanso API Documentation</h1><p><a href="index.html">Index</a> | <a href="all.html">View on single page</a></p><div class="toc"><h2>Table of Contents</h2><ul><li><a href="#types">types</a><ul><li><a href="#types.Type">Type(name, options)</a></li><li><a href="#types.Type.validate">Type.validate(doc, rawDoc)</a></li><li><a href="#types.Type.authorize">Type.authorize(nDoc, oDoc, user)</a></li><li><a href="#types.Type.authorizeTypeLevel">Type.authorizeTypeLevel(nDoc, oDoc, user)</a></li><li><a href="#types.Type.create">Type.create(userCtx, callback)</a></li><li><a href="#types.validate_doc_update">validate_doc_update(types, newDoc, oldDoc, userCtx)</a></li></ul></li></ul></div><h2 id="types">types</h2><p>Document types can be used to ease the validation of updates and check
permissions when creating, editing or deleting documents.</p><h3 id="types.Type">Type(name, options)</h3><p>Creates a new Type object</p>

<h4>Options</h4>

<ul>
<li><strong>fields</strong>       <em>Object</em> - Field objects to use as the Types's schema</li>
<li><strong>permissions</strong>  <em>Object</em> - a permissions check function or an object
               containing separate functions to run on add, remove
               and update operations.</li>
<li><strong>display_name</strong> <em>Function|String|Array</em> - name to be used when displaying
               the document in the admin tool. A string or array
               will become the property to display. A function
               should take the document as a object and return
               the display name.</li>
</ul><h4>Parameters</h4><table class="params"><tr><td class="name">options</td><td class="type">Object</td><td class="description"></td></tr></table><h3 id="types.Type.validate">Type.validate(doc, rawDoc)</h3><p>Run field validators against document and check for missing required
fields or extra fields when the Types's allow_extra_fields property is
set to false.</p><h4>Parameters</h4><table class="params"><tr><td class="name">doc</td><td class="type">Object</td><td class="description"></td></tr><tr><td class="name">rawDoc</td><td class="type">Object</td><td class="description"></td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Array</span></div><h3 id="types.Type.authorize">Type.authorize(nDoc, oDoc, user)</h3><p>Run field permissions checks against userCtx and document.</p><h4>Parameters</h4><table class="params"><tr><td class="name">nDoc</td><td class="type">Object</td><td class="description">new document</td></tr><tr><td class="name">oDoc</td><td class="type">Object</td><td class="description">old document</td></tr><tr><td class="name">userCtx</td><td class="type">Object</td><td class="description">user context object</td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Array</span></div><h3 id="types.Type.authorizeTypeLevel">Type.authorizeTypeLevel(nDoc, oDoc, user)</h3><p>Runs top type-level permissions checks only.</p><h4>Parameters</h4><table class="params"><tr><td class="name">nDoc</td><td class="type">Object</td><td class="description">new document</td></tr><tr><td class="name">oDoc</td><td class="type">Object</td><td class="description">old document</td></tr><tr><td class="name">userCtx</td><td class="type">Object</td><td class="description">user context object</td></tr></table><div class="returns"><strong>Returns: </strong><span class="type">Array</span></div><h3 id="types.Type.create">Type.create(userCtx, callback)</h3><p>Create's a new object for this Type. Pre-filling any default values and
providing a new _id value. This is a convenient function to use when creating
a type to embed within another.</p><h4>Parameters</h4><table class="params"><tr><td class="name">userCtx</td><td class="type">Object</td><td class="description"></td></tr><tr><td class="name">callback</td><td class="type">Function</td><td class="description"></td></tr></table><h3 id="types.validate_doc_update">validate_doc_update(types, newDoc, oldDoc, userCtx)</h3><p>Calls validation and permissions functions relevant to a document update.
This should be called from your app's exported validate_doc_update function
if you wish to use kanso Types in you project.</p>

<p>Throws on error.</p><h4>Parameters</h4><table class="params"><tr><td class="name">types</td><td class="type">Object</td><td class="description"></td></tr><tr><td class="name">newDoc</td><td class="type">Object</td><td class="description"></td></tr><tr><td class="name">oldDoc</td><td class="type">Object</td><td class="description"></td></tr><tr><td class="name">userCtx</td><td class="type">Object</td><td class="description"></td></tr></table>
    </div>

    <script src="http://yandex.st/highlightjs/5.16/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-20477836-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
